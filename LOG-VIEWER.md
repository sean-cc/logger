# 日志查询系统使用说明

## 🚀 快速启动

1. **启动服务器**
   ```bash
   npm start
   # 或者
   node server-simple.js
   ```

2. **访问日志查询页面**
   打开浏览器访问：http://localhost:3000

## 📋 功能特性

### 查询条件
- **日志级别**：Info、Warn、Error、Debug
- **时间范围**：支持开始时间和结束时间筛选
- **会话ID**：按特定会话查询日志
- **元数据查询**：支持JSON格式的元数据过滤
- **分页显示**：可设置每页显示的日志数量

### 界面功能
- **响应式设计**：适配桌面和移动设备
- **实时查询**：即时显示查询结果
- **清晰的日志展示**：不同级别日志用不同颜色标识
- **元数据展示**：格式化显示JSON元数据
- **操作便捷**：一键清空查询条件

## 🔧 API接口

### 查询日志
- **URL**: `POST /api/logs`
- **Content-Type**: `application/json`
- **请求体**:
  ```json
  {
    "level": "error",
    "startTime": "2025-08-19 10:00:00",
    "endTime": "2025-08-19 12:00:00",
    "sessionId": "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",
    "meta": {"userId": "123"},
    "limit": 10
  }
  ```

### 获取统计信息
- **URL**: `GET /api/logs/stats`
- **返回**: 各级别日志的统计信息

### 获取会话列表
- **URL**: `GET /api/logs/sessions`
- **返回**: 会话ID列表和统计信息

## 📝 使用示例

### 基本查询
1. 选择日志级别（可选）
2. 设置时间范围（默认最近24小时）
3. 点击"查询日志"按钮
4. 查看查询结果

### 高级查询
1. **按会话ID查询**：输入会话ID，查看特定会话的所有日志
2. **按元数据查询**：在元数据输入框中输入JSON格式的过滤条件
3. **组合查询**：可以同时使用多个查询条件

### 元数据查询示例
```json
{"userId": "123"}
{"action": "login"}
{"app": "my-app", "version": "1.0.0"}
```

## 🛠️ 技术架构

### 前端
- **纯HTML/CSS/JavaScript**：无外部依赖
- **响应式设计**：使用CSS媒体查询
- **现代UI**：渐变色彩和阴影效果

### 后端
- **Node.js HTTP服务器**：使用内置http模块
- **SQLite数据库**：轻量级数据库存储
- **RESTful API**：标准的HTTP接口

## 📊 查询结果说明

### 日志条目显示
- **级别标签**：用不同颜色区分日志级别
- **时间戳**：精确到秒的时间信息
- **会话ID**：显示日志所属的会话
- **消息内容**：主要的日志信息
- **元数据**：格式化的JSON数据

### 颜色说明
- **Info**：蓝色背景
- **Warn**：黄色背景
- **Error**：红色背景
- **Debug**：灰色背景

## 🔍 故障排除

### 常见问题
1. **无法启动服务器**：检查端口3000是否被占用
2. **查询无结果**：检查查询条件和数据库中是否有数据
3. **页面无法访问**：确认服务器已启动且端口正确

### 日志数据准备
如果数据库中没有日志数据，可以运行示例文件生成测试数据：
```bash
node example.js
node session-example.js
```

## 📝 注意事项

1. **数据库文件**：确保`logs.db`文件存在且可读
2. **权限问题**：确保Node.js进程有读取数据库文件的权限
3. **端口占用**：如果3000端口被占用，可以在代码中修改端口号
4. **浏览器兼容性**：建议使用现代浏览器（Chrome、Firefox、Safari、Edge）

## 🎯 扩展功能

系统支持以下扩展：
- 添加用户认证
- 实现日志导出功能
- 添加实时日志监控
- 集成更多查询条件
- 添加数据可视化图表